/*!
 * Start Bootstrap - SB Admin 2 v4.1.3 (https://startbootstrap.com/theme/sb-admin-2)
 * Copyright 2013-2021 Start Bootstrap
 * Licensed under MIT (https://github.com/StartBootstrap/startbootstrap-sb-admin-2/blob/master/LICENSE)
 */

var selectedFile;$("#card").hide(),console.log(window.XLSX),document.getElementById("input").addEventListener("change",function(e){selectedFile=e.target.files[0]});var data=[{name:"jayanth",data:"scd",abc:"sdef"}];document.getElementById("button").addEventListener("click",function(){if(XLSX.utils.json_to_sheet(data,"out.xlsx"),selectedFile){var e=new FileReader;e.readAsBinaryString(selectedFile);var d=[];e.onload=function(e){var a=e.target.result,n=XLSX.read(a,{type:"binary",cellDates:!0});console.log(n),n.SheetNames.forEach(function(e){var a=XLSX.utils.sheet_to_row_object_array(n.Sheets[e]);d.push(a)});var o=new Set;actions=[],d.forEach(function(e){e.forEach(function(e){actions.push(e),o.add(e["Realizado por"])})});var t=[];o.forEach(function(a){var n={nombre:a,sueldo:0,citas:0,atenciones:[]};actions.forEach(function(e){a==e["Realizado por"]&&(0==n.atenciones.length?(n.sueldo+=e.Abonado,n.citas+=1,atencion={id:e["# Tratamiento"],nombre:e["Nombre paciente"],apellido:e["Apellidos paciente"],estado:e["Estado de la consulta"],fecha:e["Fecha Realizacion"],"prestaci칩n":[e["Nombre Prestacion"]],abonado:[e.Abonado]},n.atenciones.push(atencion)):e["# Tratamiento"]==n.atenciones[n.atenciones.length-1].id?(n.sueldo+=e.Abonado,n.atenciones[n.atenciones.length-1]["prestaci칩n"].push(e["Nombre Prestacion"]),n.atenciones[n.atenciones.length-1].abonado.push(e.Abonado)):(n.sueldo+=e.Abonado,n.citas+=1,atencion={id:e["# Tratamiento"],nombre:e["Nombre paciente"],apellido:e["Apellidos paciente"],estado:e["Estado de la consulta"],fecha:e["Fecha Realizacion"],"prestaci칩n":[e["Nombre Prestacion"]],abonado:[e.Abonado]},n.atenciones.push(atencion)))}),t.push(n)}),console.log(t);var i=$("#profesionalesTable");i.find("tbody tr").remove();for(var c=0;c<t.length;c++){var s=t[c];i.append("<tr><td>"+s.nombre+"</td><td>"+s.sueldo+"</td><td>"+s.citas+"</td><td> <a class='link' href='#' id='"+c+"'>Ver M치s</a></td></tr>")}$(".link").click(function(){$("#card").show()}),$("#card-link").click(function(){$("#card").hide()})}}});